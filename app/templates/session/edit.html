{% extends "base.html" %}
{% import 'bootstrap/wtf.html' as wtf %}

{% block styles %}
{{ super() }}
{{ include_css(['markdown-editor', 'multi-select', 'bootstrap-datetimepicker']) }}
{% endblock %}

{% block scripts %}
{{ super() }}
{{ include_js(['markdown-editor', 'multi-select', 'bootstrap-datetimepicker', 'moment', 'quicksearch']) }}

<script>
{% include "sidebars.js" %}
makeMarkdownEditor("summary");

{% if current_user.has_admin_role() %}
makeMarkdownEditor("dm_notes");
{% endif %}

makeMultiSelect("participants", "Available", "Participants", "partymember-select");

moment.updateLocale('en', {
    week: { dow: 1 }
});

$("#date").wrap('<div class="input-group date" id="datetimepicker"></div>');
iga = $("<span/>").addClass("input-group-addon");
$("<span/>").addClass("fas fa-calendar-alt").appendTo(iga);
iga.appendTo($("#datetimepicker"));

var dateformat_string = "YYYY-MM-DD HH:mm";

$(function() {
    utc_d = $("#date").val();
    d = moment.utc(utc_d).local().format(dateformat_string);
    $("#date").val(d);

    $("#datetimepicker").datetimepicker({
        format: dateformat_string
    });
});

$("form").submit(function(e) {
    d = $("#date").val();
    utc_d = moment(d).utc().format(dateformat_string);
    $("#date").val(utc_d);
});
</script>
{% endblock %}

{% block app_content %}
    <h1>Edit Session</h1>

    {{ wtf.quick_form(form) }}
{% endblock %}